angular.module("BootstrapAddons",["BootstrapAddonsTemplateCache"]),angular.module("BootstrapAddons").directive("timeslider",["$document","$timeout",function(t,e){const n="timesliderSvg",a=60,i=72,r=864e5;return{restrict:"E",scope:{end:"=",onClear:"&",onChange:"&",start:"=",width:"@"},templateUrl:"timeslider/timeslider.html",replace:!0,link:function(t,l,c){function s(){e(b.extent()[0].getTime()===b.extent()[1].getTime()?function(){t.onClear()()}:function(){t.onChange()(b.extent()[0],b.extent()[1])})}function o(t,e){b.extent([t,e]),b(d3.select(".ba-brush")),b.event(d3.select(".ba-brush"))}function d(){t.actionIcon="glyphicon-play",x&&(clearInterval(x),x=null)}function m(){t.actionIcon="glyphicon-pause",x=setInterval(function(){t.stepForward()},1e3)}function u(){var e=b.extent()[1].getTime()-b.extent()[0].getTime();return 0>=e&&(e=(t.end.getTime()-t.start.getTime())/45),e}function g(){var t=b.extent();p(),t[0].getTime()!==t[1].getTime()&&(b.extent([t[0],t[1]]),b(d3.select(".ba-brush")))}function p(){f&&(t.width=l[0].clientWidth-i),t.width<=0&&(t.width=144);var e=t.width/a,r=t.end.getTime()-t.start.getTime(),c=d3.select("#ba-timeslider-container");c.selectAll("#"+n).remove();var o=c.append("svg").attr("id",n).attr("width",t.width).attr("height",22);o.append("g").append("rect").attr("x",0).attr("y",0).attr("width",t.width).attr("height",22).attr("class","ba-timeslider");var d=d3.time.scale.utc().domain([t.start.getTime(),t.end.getTime()]).range([0,parseInt(t.width,10)]),m=d(t.end.getTime()),u=null;d.ticks(e).forEach(function(t,e){var n=d(t);if(o.append("line").attr("class","ba-scaleline").attr("x1",n).attr("x2",n).attr("y1",0).attr("y2",22),n>25&&m-n>25){var a=h(r,t,u),i=a(t).split(" ");1===i.length&&i.push(""),u=t,o.append("text").attr("class","ba-scalelabel").attr("x",n).attr("dx",function(){var t="-1.25em";if(i[0].length>2)var t="-2.25em";return t}).attr("y",11).attr("text-anchor","left").attr("dominant-baseline","middle").text(i[0]),o.append("text").attr("class","ba-scalelabel").attr("x",n).attr("dx","0.25em").attr("y",11).attr("text-anchor","right").attr("dominant-baseline","middle").text(i[1])}}),b=d3.svg.brush().x(d).on("brushend",s),o.append("g").attr("class","ba-brush").call(b).selectAll("rect").attr("height",22)}function h(t,e,n){var a=null;return a=r>=t?n?d3.time.format.utc("%H %M"):d3.time.format.utc("%a %d"):24192e5>=t?n&&e.getUTCDate()===n.getUTCDate()?d3.time.format.utc("%H %M"):d3.time.format.utc("%a %d"):31536e6>=t?d3.time.format.utc("%b %d"):n&&e.getUTCFullYear()===n.getUTCFullYear()?d3.time.format.utc("%b %d"):d3.time.format.utc("%b %Y")}var b,f=!1;t.width||(f=!0),t.actionIcon="glyphicon-play";var x=null;p(),t.$on("timesliderForceRender",function(){g()}),t.togglePlay=function(){x?d():m()},t.stepBack=function(){var e=new Date(b.extent()[0].getTime()-u()),n=b.extent()[0];n.getTime()<=t.start.getTime()&&(e=new Date(t.end.getTime()-u()),n=t.end),o(e,n)},t.stepForward=function(){var e=b.extent()[1],n=new Date(b.extent()[1].getTime()+u());e.getTime()>=t.end.getTime()&&(e=t.start,n=new Date(t.start.getTime()+u())),o(e,n)}}}}]),angular.module("BootstrapAddonsTemplateCache",[]).run(["$templateCache",function(t){t.put("timeslider/timeslider.html",'<div><div class="btn-group"><button class="btn btn-xs btn-primary" ng-click="togglePlay()"><span class="glyphicon {{actionIcon}}"></span></button> <button class="btn btn-xs btn-primary" ng-click="stepBack()"><span class="glyphicon glyphicon-step-backward"></span></button> <button class="btn btn-xs btn-primary" ng-click="stepForward()"><span class="glyphicon glyphicon-step-forward"></span></button> <span id="ba-timeslider-container"></span></div></div>')}]);